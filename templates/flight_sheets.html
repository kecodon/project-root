{% extends "base.html" %}
{% block title %}Flight Sheets{% endblock %}
{% block content %}
<h2 class="mb-4">Add New Flight Sheet</h2>
<div class="card p-3">
  <div class="row g-2">
    <div class="col-md-3">
      <label>Coin</label>
      <input id="coin" class="form-control" placeholder="Type in Coin Ticker">
    </div>
    <div class="col-md-3">
      <label>Wallet</label>
      <select id="wallet" class="form-select">
        <option value="">Select wallet</option>
        {% for w in wallets %}
          <option value="{{ w.source }}">{{ w.source }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-3">
      <label>Pool</label>
      <input id="pool" class="form-control" placeholder="Select pool">
    </div>
    <div class="col-md-3">
      <label>Miner</label>
      <input id="miner" class="form-control" placeholder="Select miner">
    </div>
  </div>
  <div class="row g-2 mt-2">
    <div class="col-md-9">
      <input id="name" class="form-control" placeholder="Enter the name of the Flight Sheet">
    </div>
    <div class="col-md-3">
      <button onclick="createSheet()" class="btn btn-primary w-100">Create Flight Sheet</button>
    </div>
  </div>
</div>

<h4 class="mt-4">Current Flight Sheets</h4>
<div class="card p-3">
  {% for fs in flightsheets %}
    <div class="border-bottom py-2 d-flex justify-content-between">
      <div>
        <span class="highlight">{{ fs.coin }}</span> - {{ fs.wallet }} / {{ fs.pool }} / {{ fs.miner }}
        <div><small>{{ fs.name }}</small></div>
      </div>
      <button class="btn btn-sm btn-danger" onclick="deleteSheet('{{ fs.name }}')">Delete</button>
    </div>
  {% else %}
    <p>No flight sheets yet.</p>
  {% endfor %}
</div>

<script>
function createSheet() {
  fetch("/api/flight_sheet", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      coin: document.getElementById("coin").value,
      wallet: document.getElementById("wallet").value,
      pool: document.getElementById("pool").value,
      miner: document.getElementById("miner").value,
      name: document.getElementById("name").value
    })
  }).then(() => location.reload());
}

function deleteSheet(name) {
  fetch("/api/flight_sheet/delete", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name })
  }).then(() => location.reload());
}
</script>
{% endblock %}
<script src="/static/js/flight_sheets.js"></script>
